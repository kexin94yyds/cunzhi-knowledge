---
name: workflow-orchestrator
description: å¤š Agent å·¥ä½œæµç¼–æ’å™¨ã€‚è§¦å‘è¯ï¼šç¼–æ’ã€orchestrateã€å·¥ä½œæµã€è‡ªåŠ¨åŒ–ã€å¤šçº¿ç¨‹ã€‚
---

# /workflow-orchestrator

**æ¨¡æ¿åˆ†ç±»**: Action
**æˆç†Ÿåº¦**: L5 (Higher Order)

åŸºäº"çº¿ç¨‹ç†è®º"çš„å¤š Agent å·¥ä½œæµç¼–æ’ç³»ç»Ÿï¼Œå®ç°ï¼š
- **æ›´é•¿çš„çº¿ç¨‹** - å­ä»£ç†æŒç»­è‡ªä¸»æ‰§è¡Œ
- **æ›´åšçš„çº¿ç¨‹** - è‡ªåŠ¨è·å–å¤šç»´åº¦ä¿¡æ¯
- **æ›´å¤šçš„çº¿ç¨‹** - N ä¸ª Agent å¹¶è¡Œæ‰§è¡Œ
- **æ›´å°‘çš„äººå·¥ä»‹å…¥ç‚¹** - åªåœ¨æœ€ç»ˆå®¡æŸ¥

## æ ¸å¿ƒæ¦‚å¿µ

### å·¥ä½œå•å…ƒï¼ˆAtomic Unitï¼‰
æœ€åŸºæœ¬çš„å·¥ä½œå•å…ƒæ˜¯ï¼š**æç¤ºè¯ â†’ Agent æ‰§è¡Œ â†’ å®¡æŸ¥**

### å·¥ä½œæµæ¨¡æ¿
é¢„å®šä¹‰çš„å·¥ä½œæµï¼Œä¸²è”å¤šä¸ª Skillsï¼š

| å·¥ä½œæµ | æ­¥éª¤ | é€‚ç”¨åœºæ™¯ |
|--------|------|----------|
| `dev` | plan â†’ implement â†’ review | åŠŸèƒ½å¼€å‘ |
| `fix` | debug â†’ implement â†’ validate | Bug ä¿®å¤ |
| `doc` | plan â†’ doc-coauthoring â†’ review | æ–‡æ¡£ç¼–å†™ |
| `release` | build â†’ validate â†’ deploy | å‘å¸ƒæµç¨‹ |
| `settle` | problems â†’ regressions â†’ patterns | ç»éªŒæ²‰æ·€ |

## ä½¿ç”¨æ–¹æ³•

### 1. æ´¾å‘å•ä¸ªå·¥ä½œæµä»»åŠ¡

```
pai dev: å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½
```

ä¸»ä»£ç†ä¼šï¼š
1. ç”Ÿæˆ `plan` é˜¶æ®µæç¤ºè¯
2. å†™å…¥ `task_queue.json`
3. å­ä»£ç†é¢†å–åè‡ªåŠ¨æ‰§è¡Œ plan â†’ implement â†’ review

### 2. æ´¾å‘å¤šä¸ªå¹¶è¡Œä»»åŠ¡

```
pai 3:
1. å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½
2. ä¿®å¤é¦–é¡µç™½å± Bug
3. ç¼–å†™ API æ–‡æ¡£
```

ä¸»ä»£ç†ä¼šï¼š
1. ä¸ºæ¯ä¸ªä»»åŠ¡ç”Ÿæˆç‹¬ç«‹æç¤ºè¯
2. å†™å…¥ 3 ä¸ªä»»åŠ¡åˆ°é˜Ÿåˆ—
3. 3 ä¸ªå­ä»£ç†å¹¶è¡Œé¢†å–æ‰§è¡Œ

### 3. è‡ªå®šä¹‰å·¥ä½œæµ

```
pai custom: plan â†’ implement â†’ run-tests â†’ review
ä»»åŠ¡ï¼šé‡æ„æ”¯ä»˜æ¨¡å—
```

## å­ä»£ç†ä»»åŠ¡æ¨¡æ¿

```markdown
## å­ä»£ç†ä»»åŠ¡ {task_id}

**å·¥ä½œæµ**: {workflow_name}
**å½“å‰é˜¶æ®µ**: {current_step}/{total_steps}
**ä»»åŠ¡æè¿°**: {task_description}

### æ‰§è¡Œæ­¥éª¤
1. æ‰§è¡Œ `{current_skill}` Skill
2. å®Œæˆåè°ƒç”¨ `cunzhi_coordinator.py complete` æŠ¥å‘Š
3. å¦‚æœ‰ä¸‹ä¸€é˜¶æ®µï¼Œè‡ªåŠ¨é¢†å–ç»§ç»­

### ä¸Šä¸‹æ–‡
- é¡¹ç›®è·¯å¾„: {workspace}
- ç›¸å…³æ–‡ä»¶: {files}

*ä½ æ˜¯å­ä»£ç†ï¼Œè¯·æ‰§è¡Œä»¥ä¸Šä»»åŠ¡*ï¼š
```

## ä¸»ä»£ç†æ‰§è¡Œæµç¨‹

```python
# 1. è§£æç”¨æˆ·è¾“å…¥
workflow, tasks = parse_input(user_input)

# 2. ä¸ºæ¯ä¸ªä»»åŠ¡ç”Ÿæˆæç¤ºè¯
for task in tasks:
    prompt = generate_workflow_prompt(workflow, task)
    
    # 3. å†™å…¥ä»»åŠ¡é˜Ÿåˆ—
    os.system(f'python3 cunzhi_coordinator.py create "{prompt}"')

# 4. é€šçŸ¥ç”¨æˆ·
print(f"å·²æ´¾å‘ {len(tasks)} ä¸ªä»»åŠ¡")
print("å­ä»£ç†è¾“å…¥ '1' å³å¯é¢†å–")

# 5. ç­‰å¾…å®Œæˆé€šçŸ¥
# cunzhi_coordinator ä¼šè‡ªåŠ¨å‘é€å®Œæˆé€šçŸ¥

# 6. éªŒæ”¶
os.system('git diff --stat')
```

## å­ä»£ç†æ‰§è¡Œæµç¨‹

```python
# 1. ç”¨æˆ·è¾“å…¥ "1" æˆ– "é¢†å–"
# 2. cunzhi_hooks.py è‡ªåŠ¨æ£€æŸ¥é˜Ÿåˆ—
# 3. é¢†å–ä»»åŠ¡å¹¶æ³¨å…¥æç¤ºè¯
# 4. AI æ‰§è¡Œä»»åŠ¡
# 5. å®ŒæˆåæŠ¥å‘Š

# è‡ªåŠ¨å®ŒæˆæŠ¥å‘Š
os.system(f'python3 cunzhi_coordinator.py complete {agent_id} {task_id}')
```

## éªŒæ”¶æµç¨‹

ä¸»ä»£ç†æ”¶åˆ°å®Œæˆé€šçŸ¥åï¼š

```bash
# 1. æ£€æŸ¥å˜æ›´
git diff --stat

# 2. éªŒè¯æ ¼å¼
grep -c "^## " target_file

# 3. æ±‡æ€»æŠ¥å‘Š
python3 cunzhi_coordinator.py status
```

## è¾“å‡ºæ ¼å¼

ä¸»ä»£ç†æ´¾å‘ä»»åŠ¡åï¼Œé€šè¿‡ `å¯¸æ­¢` é€šçŸ¥ç”¨æˆ·ï¼š

```
## ä»»åŠ¡å·²æ´¾å‘

| ä»»åŠ¡ ID | å·¥ä½œæµ | æè¿° | çŠ¶æ€ |
|---------|--------|------|------|
| BATCH-004 | dev | å®ç°ç”¨æˆ·ç™»å½• | ğŸŸ¡ pending |
| BATCH-005 | fix | ä¿®å¤ç™½å± Bug | ğŸŸ¡ pending |
| BATCH-006 | doc | ç¼–å†™ API æ–‡æ¡£ | ğŸŸ¡ pending |

**å­ä»£ç†é¢†å–æ–¹å¼**ï¼šåœ¨å…¶ä»–çª—å£è¾“å…¥ `1` æˆ– `é¢†å–`
```

## ä¸ batch-task çš„åŒºåˆ«

| ç‰¹æ€§ | batch-task | workflow-orchestrator |
|------|------------|----------------------|
| ä»»åŠ¡ç±»å‹ | å•ä¸€é‡å¤ä»»åŠ¡ | å¤šé˜¶æ®µå·¥ä½œæµ |
| æ‰§è¡Œæ–¹å¼ | ä¸€æ¬¡æ€§æ‰§è¡Œ | ä¸²è”å¤šä¸ª Skills |
| é€‚ç”¨åœºæ™¯ | æ‰¹é‡å¤„ç† | å¤æ‚å¼€å‘æµç¨‹ |

## ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šå¼€å‘æ–°åŠŸèƒ½

ç”¨æˆ·è¾“å…¥ï¼š
```
pai dev: å®ç° iterate çš„æš—é»‘æ¨¡å¼
```

ä¸»ä»£ç†ç”Ÿæˆä»»åŠ¡ï¼š
```markdown
## å­ä»£ç†ä»»åŠ¡ BATCH-007

**å·¥ä½œæµ**: dev (plan â†’ implement â†’ review)
**å½“å‰é˜¶æ®µ**: 1/3 (plan)
**ä»»åŠ¡æè¿°**: å®ç° iterate çš„æš—é»‘æ¨¡å¼

### æ‰§è¡Œæ­¥éª¤
1. æ‰§è¡Œ `plan` Skillï¼Œç”Ÿæˆå®æ–½è®¡åˆ’
2. å®ŒæˆåæŠ¥å‘Šï¼Œç­‰å¾…ä¸‹ä¸€é˜¶æ®µ

*ä½ æ˜¯å­ä»£ç†ï¼Œè¯·æ‰§è¡Œä»¥ä¸Šä»»åŠ¡*ï¼š
```

### ç¤ºä¾‹ 2ï¼šå¹¶è¡Œä¿®å¤å¤šä¸ª Bug

ç”¨æˆ·è¾“å…¥ï¼š
```
pai fix 3:
1. P-2026-030 ç™½å±é—®é¢˜
2. P-2026-031 ç«¯å£æ£€æµ‹å¤±è´¥
3. P-2026-032 ä»»åŠ¡é˜Ÿåˆ—æ­»é”
```

ä¸»ä»£ç†æ´¾å‘ 3 ä¸ªç‹¬ç«‹ä»»åŠ¡ï¼Œ3 ä¸ªå­ä»£ç†å¹¶è¡Œæ‰§è¡Œã€‚
