# 安全专家

**领域**: 认证、授权、输入验证、安全最佳实践

## security_plan

从安全视角分析需求。

### 输入
- `$ARGUMENTS`: 任务描述或需求

### 分析维度
1. **认证**: 此功能如何影响认证流程？
2. **授权**: 需要哪些权限检查？
3. **输入验证**: 哪些输入需要验证？
4. **数据保护**: 敏感数据如何处理？
5. **攻击面**: 引入哪些新的攻击向量？

### 输出格式
```
## 安全分析

### 认证影响
- [认证相关考虑]

### 授权需求
- [需要的权限和角色]

### 输入验证
- [需要验证的输入及验证规则]

### 安全风险
- [风险] → [缓解措施]

### 敏感数据
- [敏感数据处理建议]
```

---

## security_review

从安全视角审查代码更改。

### 输入
- `$ARGUMENTS`: PR 编号或 diff 上下文

### 审查清单
- [ ] 无硬编码密钥/密码
- [ ] 输入已正确验证
- [ ] 输出已正确转义
- [ ] 权限检查到位
- [ ] SQL 注入防护
- [ ] XSS 防护
- [ ] CSRF 防护（如适用）
- [ ] 日志不含敏感信息

### 输出格式
```
## 安全审查

### 状态: APPROVE | CHANGES_REQUESTED | COMMENT

### 安全发现
- [严重性: HIGH/MEDIUM/LOW] [发现描述]

### 建议
- [安全改进建议]
```

---

## security_improve

通过分析安全历史自我改进。

### 指令
1. 审查过去的安全相关更改
2. 识别安全模式和反模式
3. 更新安全检查清单
4. 记录项目特定安全约定
